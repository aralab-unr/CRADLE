# CRADLE: Cooperative Adaptive Decentralized Learning and Execution for UAV network to monitor Wildfire Front

This is the codification used in the SII 2024 paper proposing CRADLE framework, an effective cooperative decentralized approach to monitor the wildfire front using multi-agent deep reinforcement learning. You are free to use all or part of the codes here presented for any purpose, provided that the paper is properly cited and the original authors properly credited. All the files here shared come with no warranties.
This project is built using Python v3.9.13 and PyTorch v1.13.0.dev20220930 over the system equipped with Apple M1 8 cores chip, Apple M1 graphics chipset and Memory 16 GB LPDDR4 configurations. Some .ipynb files are used to generate plots and images, so to access them, you need to install Jupyter Notebook (http://jupyter.readthedocs.io/en/latest/install.html) or VS Code with Jupyter notbook extension.


## Abstract

In recent times, Continuous monitoring of wildfire fronts, crucial for real-time strategy adaptation, has seen the incorporation of Unmanned Aerial Vehicles (UAVs). Although numerous UAV deployment methods have been developed over the years, most of them posses several critical challenges, such as single-point-of-failure, adversarial threats, lack of scalability, etc. due to centralization. To tackle these challenges, a completely decentralized framework for UAV network is non-trivial. In this paper, we develop a cooperative  adaptive decentralized learning and execution ({\tt CRADLE}) framework for UAV network to monitor wildfire front. Unlike conventional centralized training and decentralized execution (CTDE) approach, our proposed {\tt CRADLE} framework leverage the selective coordination approach among neighboring UAV agents and trains a team of UAVs through a double deep Q-learning (DDQN) algorithm and value decomposition networks (VDNs). The evaluation shows that our framework outperforms the state-of-the-art CTDE framework by $28.5\%$ in terms of maximum obtained rewards, and by $37.60\%$ in terms of coverage mapping.


## Files

This repository contains 3 folders: training_phase, testing_phase and figures.

In both training_phase and testing_phase folders, commonly there are CTDE and CRADLE sub-folders representing the baseline CTDE approach and our proposed CRADLE approach, respectively, followed by the graph file to plot and compare the performance of the 2 apporaches.

CTDE apporach contains
1. main: performs the root operations.
2. environment: progresses fire and interacts with the UAVs network.
3. agent: performs the deep reinforment learning model.
4. model: the neural network.

CRADLE apporach contains
1. main: performs the root operations.
2. environment: progresses fire and interacts with the UAVs network.
3. UAVagent: handles the interactions of a UAV with environment and other UAVs.
4. NNagent: performs the deep reinforment learning model.
5. model: the neural network.

The trained policies of all UAVs are stored in models folder inside their respective approaches.

Finally, the figures folder in the root directory contains all the figures used in the paper. Here, the wildfire_ts and constructed_fire_map images can be rebuilt using generate_wf_images.ipynb file with live simulation. By this, you would get an understanding of wildfire progression, the UAVs interacting with environment at each timestep and the image observation of a UAV before passing through a Neural Network. Alongside, the original and constructed fire map are captured at the final timestep. This constructed fire map is compared with the original fire map to analyze the coverage performance of the UAVs. The necessary data required to rebuilt these images are generated by compiling the main.py file inside wf_image_data_generator folder. 

From this files sections, in summary, we have, 

there are 5 python files to interpret,
1. /training_phase/CTDE/main.py
2. /training_phase/CRADLE/main.py
3. /testing_phase/CTDE/main.py
4. /testing_phase/CRADLE/main.py
5. /figures/wf_image_data_generator/main.py

3 python notebooks to run,
1. /training_phase/CRADLE/graph.ipynb
2. /testing_phase/CTDE/graph.ipynb
3. /figures/generate_wf_images.ipynb

to generate 4 plots,
1. Training performace in terms of score metrics, rewards earned and coverage.
2. Testing performace in terms of score metrics, rewards earned and coverage.
3. Wildfire progression and neural network map inputs.
4. Comparison between original and constructed fire map.


## How to use <br />

# 1. To train CTDE approach:
In the torch environment, from the root, change directory to /training_phase/CTDE/ and type
    python main.py
After training over all episodes, the policies and plot data files are stored in /models folder under a particular timestamp, ex. "t2023-08-17 16:43:57.654315".

# 2. To train CRADLE approach:
In the torch environment, from the root, change directory to /training_phase/CRADLE/ and type
    python main.py
After training over all episodes, the policies and plot data files are stored in /models folder under a particular timestamp, ex. "t2023-08-17 16:43:57.654315".

# 3. To plot the performace of the training in terms of score metrics, rewards earned and coverage:
change directory to /ROOT/training_phase/ and open gragh.ipynb in jupyter notebook or VS Code.
Run all the code inside the file to generate the 3 performace comparison graphs in terms of score metrics, rewards earned and coverage over both the approaches. The PDF file with generated graphs are stored outside, next to this file.

# 4. To test CTDE approach:
To test the trained policies, copy the policy folders from /training_phase/CTDE/models folder, change the directory to /testing_phase/CTDE/models and paste the policy folder. The folder name would look like "t2023-08-17 16:43:57.654315".
Then change directory back to /testing_phase/CTDE/.
In main.py, at line 134, replace load_path = "" with the policy timestamp that you plan to test like load_path = "t2023-08-17 16:43:57.654315" and save the file.
In the torch environment, at the /testing_phase/CTDE/ directory, type
    python main.py
After testing over an episode, all plot data files are stored in /models folder under the same policy timestamp folder that was replaced earlier at load_path variable (line 134) in main.py file.

# 5. To test CRADLE approach:
To test the trained policies, copy the policy folders from /training_phase/CRADLE/models folder, change the directory to /testing_phase/CRADLE/models and paste the policy folder. The folder name would look like "t2023-08-17 16:43:57.654315".
Then change directory back to /training_phase/CRADLE/.
In main.py, at line 40, replace load_path = "" with the policy timestamp that you plan to test like load_path = "t2023-08-17 16:43:57.654315" and save the file.
In the torch environment, at the /testing_phase/CRADLE/ directory,  type
    python main.py
After testing over an episode, all plot data files are stored in /models folder under the same policy timestamp folder that was replaced earlier at load_path variable (line 40) in main.py file.

# 6. To plot the performace of the testing in terms of score metrics, rewards earned and coverage:
Change directory to /ROOT/testing_phase/ and open gragh.ipynb in jupyter notebook or VS Code.
Run all the cells inside the file to generate the 3 performace comparison graphs in terms of score metrics, rewards earned and coverage over both the approaches. The PDF file with generated graphs are stored outside, next to this file.

# 7. To visualize the wildfire progression, map inputs, and coverage comparison between the original and constructed fire map
To generate the necessary data required to re-built the figures, change the directory to /ROOT/figures/wf_image_data_generator/ and run
    python main.py
Now, the data would have re-generated in /figureData folder. Go back to /figures folder, and open generate_wf_images.ipynb using jupyter notebook or VS Code. Run all the cells inside the file to generate all the images. These generated images will replace the existing images beside this file. You could access them at wildfire_ts.pdf and constructed_fire_map.pdf files in the same directory as this file.


## Contact
For questions about the codification or paper, <br />please send an email to gauravsrikar@nevada.unr.edu, mdtamjidh@nevada.unr.edu or aralab2018@gmail.com.

